<% content_for(:page_header) do %>
  <%= "List of IoT Data" %>
<% end %>
<% content_for :panel_heading do %>Content<% end %>
<p id="notice"><%= notice %></p>

<!-- <h1>Listing Iot Data</h1> -->

<table id="iottt" class="display table" cellspacing="0" width="95%">
  <thead>
    <tr>
      <th>WB No.</th>
      <th>Emp. Name</th>
      <th>Emp.ID</th>
      <th>Shift</th>
      <th>Part No</th>
      <th>Target</th>
      <th>Lot size</th>
      <th>Device</th>
      <th>Count</th>
      <!-- <th>Status</th> -->
      <th>Actions</th>
      <th colspan="3"></th>
    </tr>
  </thead>

  <tbody>
    <% @iot_data.each do |iot_datum| %>
      <% if iot_datum.status == 'Process Completed' %>
        <tr class="greenn">
        <% elsif iot_datum.status == 'Processing' && iot_datum.count > 0 %>
        <tr class="green">
        <% elsif iot_datum.status == 'YTS' %>
        <tr class="red">
        <% else %>
        <tr>
      <% end %>
        <td><%= iot_datum.workbench_number %></td>
        <td><%= iot_datum.employee_name %></td>
        <td><%= iot_datum.employee_id %></td>
        <td><%= iot_datum.shift %></td>
        <td><%= iot_datum.part_number %></td>
        <td><%= iot_datum.target %></td>
        <td><%= iot_datum.lot_size %></td>
        <td><%= iot_datum.device_id %></td>
        <td id="ct"><%= iot_datum.count %></td>
        <!-- <td><%#= iot_datum.status %></td> -->
        <td class="action-buttons">
          <% if iot_datum.status == 'YTS'  %> 
          <%= link_to iot_datum_process_start_path(iot_datum), class: 'btn btn-danger btn-lg '  do %>
          <i class="glyphicon glyphicon-play"></i>
          <% end %>
          <% elsif iot_datum.status == 'Process Completed' %>  
          <%= link_to '', class: 'btn btn-success btn-lg'  do %>
          <i class="glyphicon glyphicon-ok"></i>
          <% end %>
          <% elsif iot_datum.status == 'Processing' %>  
          <%= link_to '', class: 'btn btn-warning btn-lg'  do %>
          <i class="fa fa-refresh fa-spin"></i>
          <!-- <i class="fa fa-refresh fa-spin fa-2x fa-fw"></i> -->
          <% end %>
          <% end %> 
                 
          <%#= link_to 'Edit', edit_iot_datum_path(iot_datum), class: 'btn btn-primary' %>
          <%#= link_to 'Destroy', iot_datum, method: :delete, data: { confirm: 'Are you sure?' }, class: 'btn btn-danger' %>
        </td>
      </tr>
      
    <% end %>
    <!-- Total <%#= @iot_data.count %> Parts are Processing -->
  </tbody>
</table>

<br>

<%#= link_to 'New IoT data', new_iot_datum_path %>

<% content_for(:extra_scripts) do %>
  
  <script type="text/javascript">
    // function update(){ 
    //     $.get('/', function(data) {
    //       $('#ct').load(true);
    //       console.log('Test');
    //     });
    // }
    $(document).ready(function() {
      $('#iottt').DataTable({ responsive: true, ordering: false });
      setInterval('window.location.reload()', 5000);
      // window.setInterval('update()', 3*1000);
    //   var table = $('#iottt').DataTable({ responsive: true, ordering: false });
 
    // table.columns().flatten().each( function ( colIdx ) {
    // // Create the select list and search operation
    // var select = $('<select />')
    //     .appendTo(
    //         table.column(colIdx).footer()
    //     )
    //     .on( 'change', function () {
    //         table
    //             .column( colIdx )
    //             .search( $(this).val() )
    //             .draw();
    //     } );
 
    // // Get the search data for the first column and add to the select list
    // table
    //     .column( colIdx )
    //     .cache( 'search' )
    //     .sort()
    //     .unique()
    //     .each( function ( d ) {
    //         select.append( $('<option value="'+d+'">'+d+'</option>') );
    //     } );
    //   } );
    // setInterval('window.location.reload()', 10000);
    });
  </script>
<% end %>

